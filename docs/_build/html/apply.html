

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Apply methods &mdash; timeseriesjl 0.2.2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/julia.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/julia.css" type="text/css" />
  
    <link rel="top" title="timeseriesjl 0.2.2 documentation" href="index.html"/>
        <link rel="next" title="Combine methods" href="combine.html"/>
        <link rel="prev" title="Split methods: bracketing by time or boolean array" href="split.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="http://julialang.org/"><img src="_static/julia-logo.svg" class="logo"></a>
        <!--
        <a href="index.html" class="fa fa-home"> timeseriesjl</a>
        -->
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="timearray.html">The TimeArray time series type</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexing.html">Array indexing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="indexing.html#integers">Integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html#strings">Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html#date-and-datetime">Date and DateTime</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html#mixed-approach">Mixed approach</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="split.html">Split methods: bracketing by time or boolean array</a><ul>
<li class="toctree-l2"><a class="reference internal" href="split.html#by">by</a></li>
<li class="toctree-l2"><a class="reference internal" href="split.html#from">from</a></li>
<li class="toctree-l2"><a class="reference internal" href="split.html#to">to</a></li>
<li class="toctree-l2"><a class="reference internal" href="split.html#findwhen">findwhen</a></li>
<li class="toctree-l2"><a class="reference internal" href="split.html#findall">findall</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Apply methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lag">lag</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lead">lead</a></li>
<li class="toctree-l2"><a class="reference internal" href="#percentchange">percentchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moving">moving</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upto">upto</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basecall">basecall</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="combine.html">Combine methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="combine.html#merge">merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="combine.html#collapse">collapse</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readwrite.html">Read method</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readwrite.html#readtimearray">readtimearray</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dotfile.html">Customize how TimeArray is displayed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dotfile.html#decimals">DECIMALS</a></li>
<li class="toctree-l2"><a class="reference internal" href="dotfile.html#showint">SHOWINT</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">timeseriesjl</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Apply methods</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/apply.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="apply-methods">
<h1>Apply methods<a class="headerlink" href="#apply-methods" title="Permalink to this headline">¶</a></h1>
<p>Common transformation of time series data involves lagging, leading, calculating change, windowing operations and aggregation
operations. Each of these methods include keyword arguments that include defaults.</p>
<div class="section" id="lag">
<h2>lag<a class="headerlink" href="#lag" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">lag</span></tt> method simply described is putting yesterday&#8217;s value in today&#8217;s timestamp. This is the most common use case, though
there are many times the distance between timestamps is not 1 time unit. An arbitrary integer distance for lagging is supported,
with the default equal to 1.</p>
<p>The value of the <tt class="docutils literal"><span class="pre">cl</span></tt> object on Jan 3, 2000 is 111.94. On Jan 4, 2000 it is 102.50 and on Jan 5, 2000 it&#8217;s 104.0:</p>
<div class="highlight-julia"><div class="highlight"><pre><span class="n">julia</span><span class="o">&gt;</span> <span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="mi">3</span><span class="n">x1</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">TimeArray</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">DataType</span><span class="p">}</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="n">to</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>

            <span class="n">Close</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="o">|</span> <span class="mf">111.94</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">|</span> <span class="mf">102.5</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">|</span> <span class="mf">104.0</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">lag</span></tt> method <strong>moves</strong> values up one day:</p>
<div class="highlight-julia"><div class="highlight"><pre><span class="n">julia</span><span class="o">&gt;</span> <span class="n">lag</span><span class="p">(</span><span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="mi">2</span><span class="n">x1</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">TimeArray</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">DataType</span><span class="p">}</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="n">to</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>

             <span class="n">Close</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">|</span> <span class="mf">111.94</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">|</span> <span class="mf">102.5</span>
</pre></div>
</div>
<p>You will notice that since there is no known value for lagging the first day, the observation on that timestamp is
omitted. This behavior is common in TimeSeries. When observations are consumed in a transformation, the artifact dates
are not preserved with a missingness value.</p>
</div>
<div class="section" id="lead">
<h2>lead<a class="headerlink" href="#lead" title="Permalink to this headline">¶</a></h2>
<p>Leading values operates similarly to lagging values, but moves things in the other direction. Arbitrary time distances is also
supported:</p>
<div class="highlight-julia"><div class="highlight"><pre><span class="n">julia</span><span class="o">&gt;</span> <span class="n">lead</span><span class="p">(</span><span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="mi">2</span><span class="n">x1</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">TimeArray</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">DataType</span><span class="p">}</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="n">to</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>

             <span class="n">Close</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="o">|</span> <span class="mf">102.5</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">|</span> <span class="mf">104.0</span>
</pre></div>
</div>
<p>Since we are leading an object of length 3, only two values will be transformed because we have lost a day to the transformation.</p>
<p>The <tt class="docutils literal"><span class="pre">cl</span></tt> object is 500 rows long so if we lead by 499 days, we should put the last observation in the object (which happens
to be on Dec 31, 2001) into the first date&#8217;s value slot:</p>
<div class="highlight-julia"><div class="highlight"><pre><span class="n">julia</span><span class="o">&gt;</span> <span class="n">lead</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="mi">499</span><span class="p">)</span>
<span class="mi">1</span><span class="n">x1</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">TimeArray</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">DataType</span><span class="p">}</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="n">to</span> <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>

             <span class="n">Close</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="o">|</span> <span class="mf">21.9</span>
</pre></div>
</div>
</div>
<div class="section" id="percentchange">
<h2>percentchange<a class="headerlink" href="#percentchange" title="Permalink to this headline">¶</a></h2>
<p>Calculating change between timestamps is a very common time series operation. We use the terms percent change, returns and
rate of change interchangably. Depending on which domain you&#8217;re using time series, you may prefer one name over the other.</p>
<p>This package names the function that performs this transformation <tt class="docutils literal"><span class="pre">percentchange</span></tt>. You&#8217;re welcome to change this of course
if that represents too many letters for you to type:</p>
<div class="highlight-julia"><div class="highlight"><pre><span class="n">julia</span><span class="o">&gt;</span> <span class="n">roc</span> <span class="o">=</span> <span class="n">percentchange</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">percentchange</span></tt> method includes the option to return a simple return or a log return. The default is set to <tt class="docutils literal"><span class="pre">simple</span></tt>:</p>
<div class="highlight-julia"><div class="highlight"><pre>julia&gt; percentchange(cl)
499x1 TimeSeries.TimeArray{Float64,1,DataType} 2000-01-04 to 2001-12-31

             Close
2000-01-04 | -0.0843
2000-01-05 | 0.0146
2000-01-06 | -0.0865
2000-01-07 | 0.0474
⋮
2001-12-26 | 0.0061
2001-12-27 | 0.027
2001-12-28 | 0.0163
2001-12-31 | -0.0236
</pre></div>
</div>
<p>Log returns are popular for downstream calculations since adding returns is simpler than multiplying them. To create log
returns, pass the string <tt class="docutils literal"><span class="pre">log</span></tt> to the method:</p>
<div class="highlight-julia"><div class="highlight"><pre>julia&gt; percentchange(cl, method=&quot;log&quot;)
499x1 TimeSeries.TimeArray{Float64,1,DataType} 2000-01-04 to 2001-12-31

             Close
2000-01-04 | -0.0881
2000-01-05 | 0.0145
2000-01-06 | -0.0905
2000-01-07 | 0.0463
⋮
2001-12-26 | 0.0061
2001-12-27 | 0.0266
2001-12-28 | 0.0162
2001-12-31 | -0.0239
</pre></div>
</div>
</div>
<div class="section" id="moving">
<h2>moving<a class="headerlink" href="#moving" title="Permalink to this headline">¶</a></h2>
<p>Often when working with time series, you want to take a sliding window view of the data and perform a calculation on it. The
simplest example of this is the moving average. For a 10-period moving average, you take the first ten values, sum then and
divide by 10 to get their average. Then you slide the window down one and to the same thing. This operation involves two important
arguments: the function that you want to use on your window and the size of the window you want to apply that function over.</p>
<p>In our moving average example, we would pass arguments this way:</p>
<div class="highlight-julia"><div class="highlight"><pre>julia&gt; moving(cl, mean, 10)
491x1 TimeSeries.TimeArray{Float64,1,DataType} 2000-01-14 to 2001-12-31

             Close
2000-01-14 | 98.782
2000-01-18 | 97.982
2000-01-19 | 98.388
2000-01-20 | 99.338
⋮
2001-12-26 | 21.065
2001-12-27 | 21.123
2001-12-28 | 21.266
2001-12-31 | 21.417
</pre></div>
</div>
<p>As mentioned previously, we lose the first nine observations to the consuming nature of this operation. They are not <strong>missing</strong>
per se, they simply do not exist.</p>
</div>
<div class="section" id="upto">
<h2>upto<a class="headerlink" href="#upto" title="Permalink to this headline">¶</a></h2>
<p>Another operation common in time series analysis is an aggregation function. TimeSeries supports this with the <tt class="docutils literal"><span class="pre">upto</span></tt> method.
Suppose you want to keep track of the sum of all the values from the beginning to the present timestamp. You would use the
<tt class="docutils literal"><span class="pre">upto</span></tt> method like this:</p>
<div class="highlight-julia"><div class="highlight"><pre>julia&gt; upto(cl, sum)
500x1 TimeSeries.TimeArray{Float64,1,DataType} 2000-01-03 to 2001-12-31

             Close
2000-01-03 | 111.94
2000-01-04 | 214.44
2000-01-05 | 318.44
2000-01-06 | 413.44
⋮
2001-12-26 | 23028.84
2001-12-27 | 23050.91
2001-12-28 | 23073.34
2001-12-31 | 23095.24
</pre></div>
</div>
</div>
<div class="section" id="basecall">
<h2>basecall<a class="headerlink" href="#basecall" title="Permalink to this headline">¶</a></h2>
<p>Because the algorithm for the <tt class="docutils literal"><span class="pre">upto</span></tt> method needs to be optimized further, it might be better to use a base method in its
place when one is available. Taking our summation example above, we could instead use the <tt class="docutils literal"><span class="pre">basecall</span></tt> method and realize
substantial performance improvements:</p>
<div class="highlight-julia"><div class="highlight"><pre>julia&gt; basecall(cl,cumsum)
500x1 TimeSeries.TimeArray{Float64,1,DataType} 2000-01-03 to 2001-12-31

             Close
2000-01-03 | 111.94
2000-01-04 | 214.44
2000-01-05 | 318.44
2000-01-06 | 413.44
⋮
2001-12-26 | 23028.84
2001-12-27 | 23050.91
2001-12-28 | 23073.34
2001-12-31 | 23095.24
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="combine.html" class="btn btn-neutral float-right" title="Combine methods">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="split.html" class="btn btn-neutral" title="Split methods: bracketing by time or boolean array"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Multiple.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>